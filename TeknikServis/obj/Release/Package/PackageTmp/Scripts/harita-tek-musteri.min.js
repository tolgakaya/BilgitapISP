function createMarker(n,t){var r=t,i=new google.maps.Marker({position:n,map:map,icon:"/img/anten2.png",animation:google.maps.Animation.DROP,zIndex:Math.round(n.lat()*-1e5)<<5});bounds.extend(n);google.maps.event.addListener(i,"click",function(){infowindow.setContent(r);infowindow.open(map,i)})}function createMarkerM(n,t){var r=t,i=new google.maps.Marker({position:n,map:map,icon:"/img/musteri.png",animation:google.maps.Animation.BOUNCE,zIndex:Math.round(n.lat()*-1e5)<<5});bounds.extend(n);google.maps.event.addListener(i,"click",function(){infowindow.setContent(r);infowindow.open(map,i)})}function drawArc(n,t,i,r){var s=Math.PI/180,h=180/Math.PI,o=32,c=r/EarthRadiusMeters*h,l=c/Math.cos(n.lat()*s),u=[],f,e;for(t>i&&(i+=360),f=i-t,f=f/o,e=0;e<o+1;e++)u.push(n.DestinationPoint(t+e*f,r)),bounds.extend(u[u.length-1]);return u}function drawCircle(n,t){for(var u,o=Math.PI/180,s=180/Math.PI,f=32,e=t/6378137*s,h=e/Math.cos(n.lat()*o),i=[],r=0;r<f+1;r++)u=Math.PI*(r/(f/2)),ey=n.lng()+h*Math.cos(u),ex=n.lat()+e*Math.sin(u),i.push(new google.maps.LatLng(ex,ey)),bounds.extend(i[i.length-1]);return i}function GetAllAntens(){return $.ajax({type:"GET",url:"/api/Anten/",contentType:"json",dataType:"json",success:function(n){$.each(n,function(n,t){var u=JSON.stringify(t),i=$.parseJSON(u),r=i.anten_adi,f=i.center_Lat,e=i.center_Long,o=i.start_Lat,s=i.start_Long,h=i.end_Lat,c=i.end_Long,l=i.bayi,a=i.anten_id;hepsi[r]={center:new google.maps.LatLng(f,e),start:new google.maps.LatLng(o,s),end:new google.maps.LatLng(h,c),adi:r,bayi:l,anten_id:a}})},error:function(n){console.log(n)}}),hepsi}function GetMusteri(){return $.getJSON(url,function(n){var t=n.musteri_id,i=n.musteri_adi,r=n.center_Lat,u=n.center_Long,f=n.bayi;musteri={center:new google.maps.LatLng(r,u),adi:i,musteri_id:t,bayi:f}}).fail(function(){}),musteri}function getParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function tekli(n,t,i,r,u,f){var e,o;createMarker(i,"<div class='panel panel-primary'><div class='panel-heading'>"+r+"/"+u+"<\/div><div class='panel-body'><div class='table-responsive'><div class='btn btn-xs-group'><a href='javascript:map.setCenter(new google.maps.LatLng("+i.toUrlValue(6)+"));map.setZoom(20);'><i class='btn btn-xs btn-success '>Yaklaş<\/i><\/a> <a href='javascript:map.fitBounds(bounds);'><i class='btn btn-xs btn-danger'>Uzaklaş<\/i><\/a><a href='TekAnten.aspx?id="+f+"'><i class='btn btn-xs btn-primary btn-block'>Anten Müşterilerine Git<\/i> <\/a><\/div><\/div><\/div> <\/div>");e=drawArc(i,i.Bearing(n),i.Bearing(t),i.distanceFrom(n));e.push(i);bounds.extend(i);e.push(n);o=new google.maps.Polygon({paths:[e],strokeColor:"#00FF00",strokeOpacity:.5,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,map:map});poligonlar[i]={center:i,poly:o}}function initialize(){var i={zoom:10,center:new google.maps.LatLng(-33.9,151.2),mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP},n,t;map=new google.maps.Map(document.getElementById("map_canvas"),i);bounds=new google.maps.LatLngBounds;google.maps.event.addListener(map,"click",function(){infowindow.close()});for(n in antenler)tekli(antenler[n].start,antenler[n].end,antenler[n].center,antenler[n].adi,antenler[n].bayi,antenler[n].anten_id);for(t in poligonlar)poligonlar[t].poly.containsLatLng(musteri.center)&&(createMarkerM(musteri.center,"<div class='panel panel-primary'><div class='panel-heading'>"+musteri.adi+"/<\/div><div class='panel-body'><div class='table-responsive'><div class='btn btn-xs-group'><a href='javascript:map.setCenter(new google.maps.LatLng("+musteri.center.toUrlValue(6)+"));map.setZoom(20);'><i class='btn btn-xs btn-success '>Yaklaş<\/i><\/a> <a href='javascript:map.fitBounds(bounds);'><i class='btn btn-xs btn-danger'>Uzaklaş<\/i><\/a><a href='../MusteriDetayBilgileri.aspx?custID="+musteri.musteri_id+"'><i class='btn btn-xs btn-primary btn-block'>Müşteri Detay<\/i> <\/a><a href='MusteriYolu.aspx?id="+musteri.musteri_id+"'><i class='btn btn-xs btn-info btn-block'>Navigasyon<\/i> <\/a><\/div><\/div><\/div> <\/div>"),document.getElementById("txtResult").value+=musteri.musteri_id+",");map.fitBounds(bounds)}var map=null,bounds=null,antenler={},poligonlar={},hepsi={},EarthRadiusMeters=6378137,infowindow;google.maps.LatLng.prototype.DestinationPoint=function(n,t){var i=EarthRadiusMeters,n=n.toRad(),r=this.lat().toRad(),f=this.lng().toRad(),u=Math.asin(Math.sin(r)*Math.cos(t/i)+Math.cos(r)*Math.sin(t/i)*Math.cos(n)),e=f+Math.atan2(Math.sin(n)*Math.sin(t/i)*Math.cos(r),Math.cos(t/i)-Math.sin(r)*Math.sin(u));return new google.maps.LatLng(u.toDeg(),e.toDeg())};google.maps.LatLng.prototype.Bearing=function(n){var i=this,r=n;if(i.equals(r))return 0;var f=i.latRadians(),e=i.lngRadians(),u=r.latRadians(),o=r.lngRadians(),t=-Math.atan2(Math.sin(e-o)*Math.cos(u),Math.cos(f)*Math.sin(u)-Math.sin(f)*Math.cos(u)*Math.cos(e-o));return t<0&&(t+=Math.PI*2),t>Math.PI&&(t-=Math.PI*2),parseFloat(t.toDeg())};Number.prototype.toRad=function(){return this*Math.PI/180};Number.prototype.toDeg=function(){return this*180/Math.PI};Number.prototype.toBrng=function(){return(this.toDeg()+360)%360};infowindow=new google.maps.InfoWindow({size:new google.maps.Size(150,50)});antenler=GetAllAntens();var id=getParameterByName("id"),urlBase="/api/Musteri/",url=urlBase+"?id="+id,musteri=GetMusteri();
//# sourceMappingURL=harita-tek-musteri.min.js.map
